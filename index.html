<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Be Iran's Voice</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      margin: 0;
      background: #f5f5f5;
      color: #111;
      line-height: 1.6;
    }

    .container {
      max-width: 700px;
      margin: auto;
      padding: 12px;
    }

    h1 {
      font-size: 1.75rem;
      margin-bottom: 12px;
      line-height: 1.2;
    }

    h2 {
      font-size: 1.3rem;
      margin-top: 0;
      margin-bottom: 12px;
      line-height: 1.3;
    }

    p {
      font-size: 1.05rem;
      margin: 12px 0;
    }

    .box {
      background: #ffffff;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .box.priority {
      border: 3px solid #b00020;
      background: #fff8f8;
    }

    .box.priority h2 {
      color: #b00020;
      font-size: 1.4rem;
      font-weight: 700;
    }

    .badge {
      display: inline-block;
      background: #b00020;
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 8px;
      text-transform: uppercase;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 1rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 12px;
      font-size: 1.05rem;
      border: 2px solid #ddd;
      border-radius: 8px;
      transition: border-color 0.2s;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #b00020;
    }

    .button {
      display: block;
      text-align: center;
      background: #b00020;
      color: white;
      padding: 16px 20px;
      text-decoration: none;
      font-size: 1.15rem;
      font-weight: 600;
      border-radius: 10px;
      margin-top: 16px;
      transition: all 0.2s;
      border: none;
      cursor: pointer;
      min-height: 48px;
      width: 100%;
    }

    .button:active:not(:disabled) {
      transform: scale(0.98);
      background: #8a0019;
    }

    .button:disabled {
      background: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    .button.secondary {
      background: #333;
    }

    .button.secondary:active {
      background: #222;
    }

    .small {
      font-size: 0.95rem;
      color: #666;
      margin-top: 12px;
    }

    .emphasis {
      font-weight: 600;
      color: #b00020;
    }

    hr {
      border: none;
      border-top: 1px solid #ddd;
      margin: 24px 0;
    }

    .instagram-media,
    .twitter-tweet {
      margin: 20px auto !important;
      max-width: 100% !important;
    }

    .stats {
      background: #fff3cd;
      border-left: 4px solid #b00020;
      padding: 12px 16px;
      margin: 16px 0;
      border-radius: 6px;
    }

    .stats p {
      margin: 8px 0;
      font-weight: 600;
    }

    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #b00020;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
      display: inline-block;
      margin-left: 8px;
      vertical-align: middle;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .hidden {
      display: none;
    }

    .result-box {
      background: #e8f5e9;
      border: 2px solid #4caf50;
      padding: 16px;
      border-radius: 8px;
      margin-top: 16px;
    }

    .result-box p {
      margin: 8px 0;
    }

    .error {
      background: #ffebee;
      border: 2px solid #f44336;
      padding: 16px;
      border-radius: 8px;
      margin-top: 16px;
      color: #c62828;
    }

    @media (max-width: 600px) {
      .container {
        padding: 8px;
      }

      h1 {
        font-size: 1.5rem;
      }

      h2 {
        font-size: 1.2rem;
      }

      .box {
        padding: 16px;
        margin-bottom: 12px;
      }

      p {
        font-size: 1rem;
      }

      .button {
        font-size: 1.1rem;
        padding: 14px 16px;
      }
    }

    .intro-text {
      font-size: 1.1rem;
      line-height: 1.7;
    }
  </style>
</head>

<body>

<div class="container">

  <!-- INTRO -->
  <div class="box">
    <h1>üáÆüá∑ Be the Voice of Iran</h1>

    <p class="intro-text">
      The Iranian regime has systematically used violence against civilians.
    </p>

    <div class="stats">
      <p>üìä Over 30,000 people killed</p>
      <p>‚ö†Ô∏è Many victims were young people</p>
      <p>üö® Security forces use live ammunition and chemical agents</p>
    </div>

    <p class="intro-text">
      <strong>Our mission:</strong> Document evidence, raise awareness, demand action.
    </p>
  </div>

  <!-- CONTACT MP - SIMPLE VERSION -->
  <div class="box priority">
    <span class="badge">‚ö° Action Needed</span>
    <h2>Contact Your Local MP</h2>

    <p>
      <strong class="emphasis">This is the most important action you can take.</strong>
    </p>

    <p>
      Your MP can raise concerns in Parliament and support action on human rights in Iran. 
      Just enter your details below and we'll do the rest!
    </p>

    <form id="mp-form">
      <div class="form-group">
        <label for="name">Your Full Name *</label>
        <input type="text" id="name" name="name" required placeholder="e.g. John Smith">
      </div>

      <div class="form-group">
        <label for="postcode">Your Postcode *</label>
        <input type="text" id="postcode" name="postcode" required placeholder="e.g. HD4 6NR" style="text-transform: uppercase;">
      </div>

      <button type="submit" class="button" id="submit-btn">
        üìß Send Email to My MP
      </button>
    </form>

    <div id="result" class="hidden"></div>

    <p class="small">
      ‚ú® We'll automatically find your MP and create a personalized email for you - takes just 5 seconds!
    </p>
  </div>

  <!-- PETITION -->
  <div class="box">
    <h2>Sign the Petition</h2>

    <p>
      Add your voice to demand immediate humanitarian access for injured and 
      killed civilians in Iran.
    </p>

    <a class="button secondary"
       href="https://www.change.org/p/demand-immediate-humanitarian-access-to-injured-and-killed-civilians-in-iran?recruiter=1399862278"
       target="_blank"
       rel="noopener">
      ‚úçÔ∏è Sign the Petition
    </a>
  </div>

  <!-- VIDEO EVIDENCE -->
  <div class="box">
    <h2>Video Evidence</h2>

    <p>
      <strong>Warning:</strong> Some content may be distressing. These are 
      publicly shared posts documenting the violence.
    </p>

    <blockquote class="instagram-media"
      data-instgrm-permalink="https://www.instagram.com/reel/DT8yak7AXHP/"
      data-instgrm-version="14">
    </blockquote>

    <hr>

    <blockquote class="instagram-media"
      data-instgrm-permalink="https://www.instagram.com/reel/DT3uitRCnK0/"
      data-instgrm-version="14">
    </blockquote>

    <hr>

    <blockquote class="instagram-media"
      data-instgrm-permalink="https://www.instagram.com/reel/DT3Vxcpj7I2/"
      data-instgrm-version="14">
    </blockquote>

    <hr>

    <blockquote class="twitter-tweet">
      <a href="https://x.com/sofiafonsoferre/status/2012897847390183724"></a>
    </blockquote>

    <p class="small">
      Sources remain with the original creators. Shared for awareness and documentation.
    </p>
  </div>

  <!-- SHARE -->
  <div class="box">
    <h2>Share This Page</h2>
    <p>
      Help spread awareness by sharing this page with friends, family, and on social media.
    </p>
    <p class="small">
      Every share amplifies the voices of those who cannot speak.
    </p>
  </div>

</div>

<!-- Embed scripts -->
<script async src="https://www.instagram.com/embed.js"></script>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<script>
  // Auto-uppercase postcode for the user
  document.getElementById('postcode').addEventListener('input', function(e) {
    e.target.value = e.target.value.toUpperCase();
  });

  document.getElementById('mp-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const name = document.getElementById('name').value.trim();
    const postcode = document.getElementById('postcode').value.trim().toUpperCase();
    const resultDiv = document.getElementById('result');
    const button = document.getElementById('submit-btn');
    
    if (!name || !postcode) {
      resultDiv.className = 'error';
      resultDiv.innerHTML = '<p>‚ö†Ô∏è Please fill in both your name and postcode.</p>';
      resultDiv.classList.remove('hidden');
      return;
    }

    // UI Feedback: Loading
    button.disabled = true;
    button.innerHTML = 'üîç Finding your MP...<span class="spinner"></span>';
    resultDiv.classList.add('hidden');

    try {
      // 1. Get the constituency from the postcode
      const pcResponse = await fetch(`https://api.postcodes.io/postcodes/${encodeURIComponent(postcode)}`);
      if (!pcResponse.ok) throw new Error('Invalid Postcode');
      const pcData = await pcResponse.json();
      const constituency = pcData.result.parliamentary_constituency;

      // 2. Get the MP for that constituency from official Parliament API
      const mpResponse = await fetch(`https://members-api.parliament.uk/api/Location/Constituency/Search?searchText=${encodeURIComponent(constituency)}&skip=0&take=1`);
      const mpData = await mpResponse.json();
      
      if (!mpData.items || mpData.items.length === 0) throw new Error('MP not found');
      
      const mpId = mpData.items[0].value.currentRepresentation.member.value.id;
      const mpName = mpData.items[0].value.currentRepresentation.member.value.nameFullTitle;

      // 3. Get the MP's Email address
      const contactResponse = await fetch(`https://members-api.parliament.uk/api/Members/${mpId}/Contact`);
      const contactData = await contactResponse.json();
      
      // Find the parliamentary email in the contact list
      const emailObj = contactData.value.find(c => c.type === 'Parliamentary' && c.email);
      const mpEmail = emailObj ? emailObj.email : `${mpName.replace(/\s+/g, '.').toLowerCase()}@parliament.uk`;

      // UI Success
      resultDiv.className = 'result-box';
      resultDiv.innerHTML = `
        <p><strong>‚úÖ Found your MP: ${mpName}</strong></p>
        <p>Constituency: ${constituency}</p>
        <p>Opening your email client now...</p>
      `;
      resultDiv.classList.remove('hidden');

      // 4. Create and Open the Email
      const subject = encodeURIComponent('Urgent: Human Rights Concerns in Iran');
      const body = encodeURIComponent(
        `Dear ${mpName},\n\n` +
        `I am writing as your constituent from ${postcode} to express serious concern about the ongoing violence against civilians in Iran.\n\n` +
        `Over 30,000 people have been killed, and I urge you to raise this issue in Parliament and press for international accountability.\n\n` +
        `Thank you for your attention to this urgent matter.\n\n` +
        `Yours sincerely,\n` +
        `${name}\n` +
        `${postcode}`
      );

      const mailtoLink = `mailto:${mpEmail}?subject=${subject}&body=${body}`;
      
      setTimeout(() => {
        window.location.href = mailtoLink;
        button.disabled = false;
        button.innerHTML = '‚úÖ Email Prepared - Send Another?';
      }, 1500);

    } catch (error) {
      console.error('Error:', error);
      resultDiv.className = 'error';
      resultDiv.innerHTML = `
        <p><strong>‚ö†Ô∏è Sorry, we couldn't find your MP automatically.</strong></p>
        <p>This could be due to an incorrect postcode or a temporary connection issue.</p>
        <p>Please check your postcode or visit <a href="https://www.theyworkforyou.com" target="_blank">TheyWorkForYou</a>.</p>
      `;
      resultDiv.classList.remove('hidden');
      button.disabled = false;
      button.innerHTML = 'üìß Send Email to My MP';
    }
  });
</script>
<script data-goatcounter="https://be-irans-voice.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
