<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Be Iran's Voice</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      margin: 0;
      background: #f5f5f5;
      color: #111;
      line-height: 1.6;
    }

    .container {
      max-width: 700px;
      margin: auto;
      padding: 12px;
    }

    h1 {
      font-size: 1.75rem;
      margin-bottom: 12px;
      line-height: 1.2;
    }

    h2 {
      font-size: 1.3rem;
      margin-top: 0;
      margin-bottom: 12px;
      line-height: 1.3;
    }

    p {
      font-size: 1.05rem;
      margin: 12px 0;
    }

    .box {
      background: #ffffff;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    /* Highlight the MP contact box */
    .box.priority {
      border: 3px solid #b00020;
      background: #fff8f8;
    }

    .box.priority h2 {
      color: #b00020;
      font-size: 1.4rem;
      font-weight: 700;
    }

    .badge {
      display: inline-block;
      background: #b00020;
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 8px;
      text-transform: uppercase;
    }

    /* Form styles */
    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 1rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 12px;
      font-size: 1.05rem;
      border: 2px solid #ddd;
      border-radius: 8px;
      transition: border-color 0.2s;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #b00020;
    }

    .button {
      display: block;
      text-align: center;
      background: #b00020;
      color: white;
      padding: 16px 20px;
      text-decoration: none;
      font-size: 1.15rem;
      font-weight: 600;
      border-radius: 10px;
      margin-top: 16px;
      transition: all 0.2s;
      border: none;
      cursor: pointer;
      min-height: 48px;
      width: 100%;
    }

    .button:active {
      transform: scale(0.98);
      background: #8a0019;
    }

    .button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .button.secondary {
      background: #333;
    }

    .button.secondary:active {
      background: #222;
    }

    .small {
      font-size: 0.95rem;
      color: #666;
      margin-top: 12px;
    }

    .emphasis {
      font-weight: 600;
      color: #b00020;
    }

    hr {
      border: none;
      border-top: 1px solid #ddd;
      margin: 24px 0;
    }

    /* Better spacing for embedded content on mobile */
    .instagram-media,
    .twitter-tweet {
      margin: 20px auto !important;
      max-width: 100% !important;
    }

    /* Stats highlight */
    .stats {
      background: #fff3cd;
      border-left: 4px solid #b00020;
      padding: 12px 16px;
      margin: 16px 0;
      border-radius: 6px;
    }

    .stats p {
      margin: 8px 0;
      font-weight: 600;
    }

    /* Loading spinner */
    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #b00020;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
      display: inline-block;
      margin-left: 8px;
      vertical-align: middle;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .hidden {
      display: none;
    }

    .mp-info {
      background: #e8f5e9;
      border: 2px solid #4caf50;
      padding: 12px;
      border-radius: 8px;
      margin-top: 12px;
    }

    .mp-info p {
      margin: 6px 0;
    }

    .error {
      background: #ffebee;
      border: 2px solid #f44336;
      padding: 12px;
      border-radius: 8px;
      margin-top: 12px;
      color: #c62828;
    }

    .error a {
      color: #b00020;
      font-weight: 600;
    }

    /* Mobile improvements */
    @media (max-width: 600px) {
      .container {
        padding: 8px;
      }

      h1 {
        font-size: 1.5rem;
      }

      h2 {
        font-size: 1.2rem;
      }

      .box {
        padding: 16px;
        margin-bottom: 12px;
      }

      p {
        font-size: 1rem;
      }

      .button {
        font-size: 1.1rem;
        padding: 14px 16px;
      }
    }

    /* Improve readability */
    .intro-text {
      font-size: 1.1rem;
      line-height: 1.7;
    }
  </style>
</head>

<body>

<div class="container">

  <!-- INTRO -->
  <div class="box">
    <h1>üáÆüá∑ Be the Voice of Iran</h1>

    <p class="intro-text">
      The Iranian regime has systematically used violence against civilians.
    </p>

    <div class="stats">
      <p>üìä Over 30,000 people killed</p>
      <p>‚ö†Ô∏è Many victims were young people</p>
      <p>üö® Security forces use live ammunition and chemical agents</p>
    </div>

    <p class="intro-text">
      <strong>Our mission:</strong> Document evidence, raise awareness, demand action.
    </p>
  </div>

  <!-- CONTACT MP - MOVED TO TOP & EMPHASIZED -->
  <div class="box priority">
    <span class="badge">‚ö° Action Needed</span>
    <h2>Contact Your Local MP</h2>

    <p>
      <strong class="emphasis">This is the most important action you can take.</strong>
    </p>

    <p>
      Your MP can raise concerns in Parliament and support action on human rights in Iran. 
      A single email from you makes a real difference.
    </p>

    <!-- Form to collect user details -->
    <form id="mp-form">
      <div class="form-group">
        <label for="name">Your Full Name *</label>
        <input type="text" id="name" name="name" required placeholder="e.g. John Smith">
      </div>

      <div class="form-group">
        <label for="postcode">Your Postcode *</label>
        <input type="text" id="postcode" name="postcode" required placeholder="e.g. HD4 6NR" style="text-transform: uppercase;">
      </div>

      <button type="submit" class="button" id="find-mp-btn">
        üìß Find My MP & Send Email
      </button>
    </form>

    <!-- MP info display -->
    <div id="mp-result" class="hidden"></div>

    <p class="small">
      We'll find your MP based on your postcode and open a personalized email ready to send.
    </p>
  </div>

  <!-- PETITION -->
  <div class="box">
    <h2>Sign the Petition</h2>

    <p>
      Add your voice to demand immediate humanitarian access for injured and 
      killed civilians in Iran.
    </p>

    <a class="button secondary"
       href="https://www.change.org/p/demand-immediate-humanitarian-access-to-injured-and-killed-civilians-in-iran?recruiter=1399862278"
       target="_blank"
       rel="noopener">
      ‚úçÔ∏è Sign the Petition
    </a>
  </div>

  <!-- VIDEO EVIDENCE -->
  <div class="box">
    <h2>Video Evidence</h2>

    <p>
      <strong>Warning:</strong> Some content may be distressing. These are 
      publicly shared posts documenting the violence.
    </p>

    <blockquote class="instagram-media"
      data-instgrm-permalink="https://www.instagram.com/reel/DT8yak7AXHP/"
      data-instgrm-version="14">
    </blockquote>

    <hr>

    <blockquote class="instagram-media"
      data-instgrm-permalink="https://www.instagram.com/reel/DT3uitRCnK0/"
      data-instgrm-version="14">
    </blockquote>

    <hr>

    <blockquote class="instagram-media"
      data-instgrm-permalink="https://www.instagram.com/reel/DT3Vxcpj7I2/"
      data-instgrm-version="14">
    </blockquote>

    <hr>

    <blockquote class="twitter-tweet">
      <a href="https://x.com/sofiafonsoferre/status/2012897847390183724"></a>
    </blockquote>

    <p class="small">
      Sources remain with the original creators. Shared for awareness and documentation.
    </p>
  </div>

  <!-- SHARE -->
  <div class="box">
    <h2>Share This Page</h2>
    <p>
      Help spread awareness by sharing this page with friends, family, and on social media.
    </p>
    <p class="small">
      Every share amplifies the voices of those who cannot speak.
    </p>
  </div>

</div>

<!-- Embed scripts -->
<script async src="https://www.instagram.com/embed.js"></script>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<script>
  document.getElementById('mp-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const name = document.getElementById('name').value.trim();
    const postcode = document.getElementById('postcode').value.trim().toUpperCase().replace(/\s+/g, '');
    const resultDiv = document.getElementById('mp-result');
    const button = document.getElementById('find-mp-btn');
    
    // Validate inputs
    if (!name || !postcode) {
      resultDiv.className = 'error';
      resultDiv.innerHTML = '<p>‚ö†Ô∏è Please fill in both your name and postcode.</p>';
      resultDiv.classList.remove('hidden');
      return;
    }

    // Show loading state
    button.disabled = true;
    button.innerHTML = 'üîç Finding your MP<span class="spinner"></span>';
    resultDiv.classList.add('hidden');

    try {
      // Method 1: Try postcodes.io to get constituency
      let constituencyName = null;
      let mpName = null;
      let mpEmail = null;

      try {
        const postcodeResponse = await fetch(`https://api.postcodes.io/postcodes/${encodeURIComponent(postcode)}`);
        const postcodeData = await postcodeResponse.json();
        
        if (postcodeData.status === 200 && postcodeData.result) {
          constituencyName = postcodeData.result.parliamentary_constituency;
        }
      } catch (err) {
        console.log('Postcodes.io failed, trying alternative...');
      }

      // Method 2: If we have constituency, look up MP
      if (constituencyName) {
        // Use TheyWorkForYou API
        try {
          const mpResponse = await fetch(`https://www.theyworkforyou.com/api/getMP?postcode=${encodeURIComponent(postcode)}&output=js`);
          const mpText = await mpResponse.text();
          const mpData = JSON.parse(mpText);
          
          if (mpData && mpData.name) {
            mpName = mpData.name;
            // Format email: firstname.lastname@parliament.uk
            const nameParts = mpData.name.toLowerCase().split(' ');
            mpEmail = `${nameParts.join('.')}@parliament.uk`;
          }
        } catch (err) {
          console.log('TheyWorkForYou API failed');
        }
      }

      // If we still don't have MP info, throw error
      if (!mpName || !mpEmail || !constituencyName) {
        throw new Error('Could not find MP information');
      }

      // Format postcode nicely for display
      const formattedPostcode = postcode.slice(0, -3) + ' ' + postcode.slice(-3);

      // Show MP info
      resultDiv.className = 'mp-info';
      resultDiv.innerHTML = `
        <p><strong>‚úÖ Your MP Found:</strong></p>
        <p><strong>${mpName}</strong></p>
        <p>Constituency: ${constituencyName}</p>
        <p>Click the button below to send your email!</p>
      `;
      resultDiv.classList.remove('hidden');

      // Create personalized email
      const subject = encodeURIComponent('Urgent: Violence against civilians in Iran');
      const body = encodeURIComponent(
        `Dear ${mpName},\n\n` +
        `I am writing as your constituent from ${formattedPostcode} to express serious concern about the ongoing violence against civilians in Iran.\n\n` +
        `Over 30,000 people have been killed by the Iranian regime, many of them young people. Security forces continue to use live ammunition and chemical agents against unarmed civilians.\n\n` +
        `I urge you to:\n` +
        `1. Raise this issue in Parliament\n` +
        `2. Support calls for accountability and humanitarian access\n` +
        `3. Press for international action on human rights violations in Iran\n\n` +
        `Thank you for your attention to this urgent matter.\n\n` +
        `Yours sincerely,\n` +
        `${name}\n` +
        `${formattedPostcode}`
      );

      const mailtoLink = `mailto:${mpEmail}?subject=${subject}&body=${body}`;

      // Update button to send email
      button.disabled = false;
      button.innerHTML = `üìß Send Email to ${mpName.split(' ')[0]}`;
      button.onclick = function(e) {
        e.preventDefault();
        window.location.href = mailtoLink;
      };

    } catch (error) {
      console.error('Error:', error);
      resultDiv.className = 'error';
      resultDiv.innerHTML = `
        <p><strong>‚ö†Ô∏è Could not find your MP automatically.</strong></p>
        <p>Please try one of these options:</p>
        <p>1. Visit <a href="https://www.theyworkforyou.com/postcode/" target="_blank">TheyWorkForYou</a> to find your MP</p>
        <p>2. Visit <a href="https://members.parliament.uk/FindYourMP" target="_blank">Parliament website</a></p>
        <p>3. Double-check your postcode is correct (e.g. HD4 6NR)</p>
      `;
      resultDiv.classList.remove('hidden');
      button.disabled = false;
      button.innerHTML = 'üìß Find My MP & Send Email';
    }
  });

  // Format postcode as user types
  document.getElementById('postcode').addEventListener('input', function(e) {
    e.target.value = e.target.value.toUpperCase();
  });
</script>

</body>
</html>
